<!DOCTYPE html><html><head><title>Pre-calculating large tables of values</title><meta charset="utf-8"><meta content="width=device-width, initiali-scale=1.0, user-scalable=yes" name="viewport"><link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css"><link href="/css/smartphone.css" media="only screen and (max-device-width:480px)" rel="stylesheet" type="text/css"><link href="/css/feedList.css" rel="stylesheet" type="text/css"><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                           m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-43966261-1', 'rmflight.github.io');
ga('send', 'pageview');

</script><!-- Styles for R syntax highlighter -->
  <style type="text/css">
  pre .operator,
pre .paren {
  color: rgb(104, 118, 135)
}

pre .literal {
  color: rgb(88, 72, 246)
}

pre .number {
  color: rgb(0, 0, 205);
}

pre .comment {
  color: rgb(76, 136, 107);
}

pre .keyword {
  color: rgb(0, 0, 255);
}

pre .identifier {
  color: rgb(0, 0, 0);
}

pre .string {
  color: rgb(3, 106, 7);
}
</style>
  
  <!-- R syntax highlighter -->
  <script type="text/javascript">
  var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>
  <script>
  window.Krux||((Krux=function(){Krux.q.push(arguments)}).q=[]);
(function(){
  var k = document.createElement('script');k.type = 'text/javascript';k.async = true;
  var m,src = (m=location.href.match(/\bkwsrc=([^&]+)\b/))&&decodeURIComponent(m[1]);
  k.src = src ||(location.protocol === "https:" ? "https:" : "http:") + 
    '//cdn.krxd.net/static/socialtag/widget.js';
  var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(k,s); 
})();
</script></head><body><div class="container-fluid well"><h1>Deciphering life: One bit at a time</h1><p>Robert M Flight's home on the web</p></div><div class="subnav"><ul class="nav nav-pills"><li><a href="/index.html">Home</a></li><li><a href="/pages/about.html">About</a></li><li><a href="/pages/archive.html">Blog Archive</a></li><li><a href="https://github.com/rmflight/researchBlog">Blog Source</a></li><li><a href="https://github.com/rmflight?tab=repositories">Github Repos</a></li><li><a href="http://www.ncbi.nlm.nih.gov/myncbi/robert%20m.flight.1/comments/">PubmedCommons Comments</a></li><li><a href="/pages/cv.html">CV</a></li></ul></div><div class="container-fluid"><div class="row-fluid"><div class="span1"></div><div class="span9"><h1>Pre-calculating large tables of values</h1>

<p>I&#39;m currently working on a project where we want to know, based on a euclidian distance measure, what is the probability that the value is a match to the another value. <em>i.e.</em> given an actual value, and a theoretical value from calculation, what is the probability that they are the same? This can be calculated using a <strong>chi-square</strong> distribution with one degree-of-freedom, easily enough by considering how much of the chi-cdf we are taking up.</p>

<pre><code>pMatch &lt;- 1 - pchisq(distVal, 1)
</code></pre>

<p>The catch is, we want to do this a whole lot of times, in <code>c++</code>. We could use the <code>boost</code> library to calculate the <strong>chi-square</strong> each time we need it. Or we could generate a lookup table that is able to find the p-value simply based on the distance. This is especially attractive if we have a limit past which we consider the probability of a match as being zero, and if we use enough decimal points that we don&#39;t suffer too much in precision.</p>

<p>Although our goal is to implement this in <strong>c++</strong>, I also want to prototype, demonstrate and evaluate the approach in <code>R</code>.</p>

<h2>R</h2>

<h3>Random number set</h3>

<p>We are going to consider 25 (5 standard deviations squared) as our cutoff for saying the probability is zero. So to make sure we are doing all calculations using the exact same thing, we will pre-generate the values for testing on <strong>real</strong> data, in this case a set of 1000000 random numbers from zero to 25.</p>

<pre><code class="r">nPoint &lt;- 1e+06
randomData &lt;- abs(rnorm(nPoint, mean = 5, sd = 5))  # take absolute so we have only positive values
randomData[randomData &gt; 25] &lt;- 25
hist(randomData, 100)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk genRandomData"/> </p>

<h3>The R way</h3>

<p>Of course, the way to calculate <strong>p-values</strong> for all this data in <code>R</code> is to do the whole vector at once. How long does that take?</p>

<pre><code class="r">bTime &lt;- Sys.time()
actPVals &lt;- 1 - pchisq(randomData, 1)
eTime &lt;- Sys.time()
rwayDiff &lt;- difftime(eTime, bTime)
rwayDiff
</code></pre>

<pre><code>## Time difference of 0.777 secs
</code></pre>

<h3>Naive way</h3>

<p>A naive way to do this is to do it piecemeal, in a for loop. I will pre-allocate the result vector so we don&#39;t take a hit on memory allocation.</p>

<pre><code class="r">naiveRes &lt;- numeric(nPoint)
bTime &lt;- Sys.time()
for (iP in 1:nPoint) {
    naiveRes[iP] &lt;- 1 - pchisq(randomData[iP], 1)
}
eTime &lt;- Sys.time()
naiveDiff &lt;- difftime(eTime, bTime)
naiveDiff
</code></pre>

<pre><code>## Time difference of 7.921 secs
</code></pre>

<p>So this takes almost 10 times longer. Which of course, is why you are encouraged to do vectorized calculations whenever possible in <code>R</code>, but you already knew that, didn&#39;t you?</p>

<h3>Lookup table</h3>

<p>What if we now store a set of p-value results in a table, doing it in such a way as to use the actual distance as an index into the table?</p>

<pre><code class="r">nDivision &lt;- 10000
dof &lt;- 1
nSD &lt;- 25

nElements &lt;- nSD * nDivision

chiVals &lt;- seq(0, nElements, 1)/nDivision  # the chi-squared values (or distances), also used as indices when multiplied by 10000

pTable &lt;- 1 - pchisq(chiVals, 1)  # the actual chi-square p-values for those distances
</code></pre>

<p>To find a value, we just multiply the distance by 10000 (the number of divisions), and add 1 (because <code>R</code> uses 1 based indexing instead of zero).</p>

<pre><code class="r">testVal &lt;- sample(chiVals, 1)  # grab a value from the chiVals previously generated
pTable[(testVal * nDivision) + 1]
</code></pre>

<pre><code>## [1] 2.471e-05
</code></pre>

<pre><code class="r">1 - pchisq(testVal, 1)
</code></pre>

<pre><code>## [1] 2.471e-05
</code></pre>

<p>How long does this take compared to the other approaches?</p>

<pre><code class="r">tableRes &lt;- numeric(nPoint)
bTime &lt;- Sys.time()
for (iP in 1:nPoint) {
    tableRes[iP] &lt;- pTable[(randomData[iP] * nDivision) + 1]
}
eTime &lt;- Sys.time()
tableDiff &lt;- difftime(eTime, bTime)
tableDiff
</code></pre>

<pre><code>## Time difference of 4.557 secs
</code></pre>

<p>So somewhere in-between the two. So not as good as doing a vectorized call, but better than making a call each time. Which is actually what I expected. What about any loss in precision of the values returned?</p>

<pre><code class="r">tableRawPrecision &lt;- abs(tableRes - actPVals)/actPVals * 100

precTable &lt;- data.frame(org = actPVals, table = tableRes, percError = tableRawPrecision)
ggplot(precTable, aes(x = org, y = table)) + geom_point()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk tablePres"/> </p>

<pre><code class="r">ggplot(precTable, aes(x = org, y = percError)) + geom_point()
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk tablePres"/> </p>

<p>So, according to this, we are only introducing error at 0.782%, which isn&#39;t much. And the values look like the are well correlated, so we should be good. </p>

<p>Now, how do these approaches compare when using <code>c++</code>?</p>

<h2>C++</h2>

<p>So it&#39;s a fair comparison, the code below actually writes the <code>c++</code> program we are going to use, with the random numbers for the <strong>p-value</strong> calculation stored as part of the code file. </p>

<p>A couple of notes:</p>

<ol>
<li>To be fair, both versions of the code have the set of random numbers and the lookup table as <code>float</code> variables, so that there is no difference in each for memory allocation.</li>
<li>Neither one stores the results of the calculation, we don&#39;t need it for this demonstration.</li>
</ol>

<h3>Raw calculations</h3>

<pre><code class="r">cppRaw &lt;- c(&quot;#include &lt;iostream&gt;&quot;, &quot;#include &lt;boost/math/distributions/chi_squared.hpp&gt;&quot;, 
    &quot;int nVal = 1000000;&quot;, &quot;double dof = 1.0;&quot;, &quot;int i;&quot;, paste(&quot;float randVals[1000000] = {&quot;, 
        paste(as.character(randomData), sep = &quot;&quot;, collapse = &quot;, &quot;), &quot;};&quot;, sep = &quot;&quot;, 
        collapse = &quot;&quot;), paste(&quot;float pTable[250001] = {&quot;, paste(as.character(pTable), 
        sep = &quot;&quot;, collapse = &quot;, &quot;), &quot;};&quot;, sep = &quot;&quot;, collapse = &quot;&quot;), &quot;int main() {&quot;, 
    &quot;using boost::math::chi_squared_distribution;&quot;, &quot;chi_squared_distribution&lt;&gt; myChi(dof);&quot;, 
    &quot;for (i = 0; i &lt; nVal; i++){&quot;, &quot;1 - cdf(myChi, randVals[i]);&quot;, &quot;};&quot;, &quot;return(0);&quot;, 
    &quot;};&quot;)
cat(cppRaw, sep = &quot;\n&quot;, file = &quot;cppRaw.cpp&quot;)

system(&quot;g++ cppRaw.cpp -o cppRaw.out&quot;)
system(&quot;time ./cppRaw.out&quot;)
</code></pre>

<pre><code>real  0m0.642s
user    0m0.631s
sys 0m0.001s
</code></pre>

<pre><code class="r">cppLookup &lt;- c(&quot;#include &lt;iostream&gt;&quot;, &quot;#include &lt;boost/math/distributions/chi_squared.hpp&gt;&quot;, 
    &quot;int nVal = 1000000;&quot;, &quot;double dof = 1.0;&quot;, &quot;int i;&quot;, paste(&quot;float randVals[1000000] = {&quot;, 
        paste(as.character(randomData), sep = &quot;&quot;, collapse = &quot;, &quot;), &quot;};&quot;, sep = &quot;&quot;, 
        collapse = &quot;&quot;), paste(&quot;float pTable[250001] = {&quot;, paste(as.character(pTable), 
        sep = &quot;&quot;, collapse = &quot;, &quot;), &quot;};&quot;, sep = &quot;&quot;, collapse = &quot;&quot;), &quot;int main() {&quot;, 
    &quot;using boost::math::chi_squared_distribution;&quot;, &quot;chi_squared_distribution&lt;&gt; myChi(dof);&quot;, 
    &quot;for (i = 0; i &lt; nVal; i++){&quot;, &quot;pTable[(int(randVals[i] * nVal))];&quot;, &quot;};&quot;, 
    &quot;return(0);&quot;, &quot;};&quot;)
cat(cppLookup, sep = &quot;\n&quot;, file = &quot;cppLookup.cpp&quot;)
system(&quot;g++ cppLookup.cpp -o cppLookup.out&quot;)
system(&quot;time ./cppLookup.out&quot;)
</code></pre>

<pre><code>real  0m0.009s
user    0m0.003s
sys 0m0.001s
</code></pre>

<p>So bypassing <code>boost</code> in this case is a good thing, we get some extra speed, and reduce a dependency. We have to generate the lookup table first, but the <code>cpp</code> file can be generated once, with a static variable in a class that is initialized to the lookup values. We do have some error, but in our case we can live with it, as the relative rankings should still be pretty good.</p>
<h5>Tagged in: <a href="/tags/R.html">R</a>, <a href="/tags/precalculate.html">precalculate</a>, <a href="/tags/hpc.html">hpc</a></h5><h6>Posted on 2013-10-17</h6><a href="https://twitter.com/share" class="twitter-share-button" data-via="rmflight" data-size="large">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><div id="disqus_thread"></div>
  <script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'decipheringlife'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div><div class="span2"><a class="twitter-timeline" href="https://twitter.com/rmflight" data-widget-id="368415899268558848">Tweets by @rmflight</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<h3>Feeds</h3><ul class="feed-list"><li><a href="/rss.xml">SiteWide Feed</a></li><li><a href="/tags/R.xml">R Feed</a></li></ul><h3>Blog Roll</h3><ul><li><a href="http://www.r-bloggers.com/">R bloggers</a></li><li><a href="http://ivory.idyll.org/blog/">Living in an Ivory Basement</a></li><li><a href="http://bytesizebio.net/">Byte Size Biology</a></li><li><a href="http://robjhyndman.com/hyndsight/">Hyndsight</a></li><li><a href="http://solomonmessing.wordpress.com/blog/">Solomon Messing</a></li><li><a href="http://nsaunders.wordpress.com/">What You're Doing Is Rather Desperate</a></li><li><a href="http://yihui.name/en/">Yihui Xie's Blog</a></li><li><a href="http://simplystatistics.org/">Simply Statistics</a></li><li><a href="http://software-carpentry.org/">Software carpentry</a></li></ul><h3>Tags</h3><ul><li><a href="/tags/R.html">R (20)</a></li><li><a href="/tags/bioconductor.html">bioconductor (3)</a></li><li><a href="/tags/cdf.html">cdf (1)</a></li><li><a href="/tags/openscience.html">openscience (9)</a></li><li><a href="/tags/reproducibility.html">reproducibility (3)</a></li><li><a href="/tags/tutorial.html">tutorial (2)</a></li><li><a href="/tags/science.html">science (2)</a></li><li><a href="/tags/hiveplot.html">hiveplot (1)</a></li><li><a href="/tags/cytoscape.html">cytoscape (1)</a></li><li><a href="/tags/literateprogramming.html">literateprogramming (1)</a></li><li><a href="/tags/writing.html">writing (1)</a></li><li><a href="/tags/package.html">package (2)</a></li><li><a href="/tags/timhortons.html">timhortons (1)</a></li><li><a href="/tags/mapping.html">mapping (1)</a></li><li><a href="/tags/teaching.html">teaching (1)</a></li><li><a href="/tags/notebook.html">notebook (1)</a></li><li><a href="/tags/moving.html">moving (2)</a></li><li><a href="/tags/Samatha.html">Samatha (2)</a></li><li><a href="/tags/twitter.html">twitter (3)</a></li><li><a href="/tags/rstudio.html">rstudio (1)</a></li><li><a href="/tags/postdoc.html">postdoc (2)</a></li><li><a href="/tags/academia.html">academia (1)</a></li><li><a href="/tags/packages.html">packages (4)</a></li><li><a href="/tags/precalculate.html">precalculate (1)</a></li><li><a href="/tags/hpc.html">hpc (1)</a></li><li><a href="/tags/python.html">python (1)</a></li><li><a href="/tags/pubmedcommons.html">pubmedcommons (1)</a></li><li><a href="/tags/learning.html">learning (1)</a></li><li><a href="/tags/softwarecarpentry.html">softwarecarpentry (1)</a></li><li><a href="/tags/git.html">git (1)</a></li><li><a href="/tags/matlab.html">matlab (1)</a></li><li><a href="/tags/documentation.html">documentation (1)</a></li><li><a href="/tags/help.html">help (1)</a></li><li><a href="/tags/optimization.html">optimization (1)</a></li><li><a href="/tags/genetic.html">genetic (1)</a></li><li><a href="/tags/algorithm.html">algorithm (1)</a></li><li><a href="/tags/simulated.html">simulated (1)</a></li><li><a href="/tags/annealing.html">annealing (1)</a></li><li><a href="/tags/meta-analysis.html">meta-analysis (1)</a></li><li><a href="/tags/publication.html">publication (1)</a></li><li><a href="/tags/bioinformatics.html">bioinformatics (1)</a></li><li><a href="/tags/github.html">github (1)</a></li><li><a href="/tags/development.html">development (2)</a></li><li><a href="/tags/vignettes.html">vignettes (2)</a></li><li><a href="/tags/career.html">career (1)</a></li><li><a href="/tags/phdisabled.html">phdisabled (1)</a></li><li><a href="/tags/migraines.html">migraines (1)</a></li><li><a href="/tags/zinc.html">zinc (1)</a></li><li><a href="/tags/visualization.html">visualization (1)</a></li></ul></div></div><div class="span12"><div class="span2"></div><div class="span8"><footer class="footer"><p class="right back_to_top"><a href="#">&uArr; Page Top</a></p><p><a href="https://github.com/DASpringate/samatha">Built in R with Samatha</a></p></footer></div></div></div></body></html>